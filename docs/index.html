<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>keyvaluestore: KeyValueStore Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">keyvaluestore<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">A flexible key-value store with multiple backend implementations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">KeyValueStore Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> A high-performance, thread-safe key-value store library in C++ that provides both in-memory and optional SQLite-based persistent storage. The library supports multiple value types and script-based isolation, making it ideal for applications requiring segregated data storage.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Features</h1>
<ul>
<li>Thread-safe operations</li>
<li>Multiple backend implementations:<ul>
<li>In-memory store for high-performance temporary storage</li>
<li>Optional SQLite-based store for persistent storage</li>
</ul>
</li>
<li>Script-based data isolation</li>
<li>Support for multiple value types:<ul>
<li>String</li>
<li>Integer</li>
<li>Double</li>
<li>Boolean</li>
</ul>
</li>
<li>Modern C++ design (C++20)</li>
<li>Comprehensive test coverage</li>
<li>Simple, consistent API</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Requirements</h1>
<ul>
<li>C++20 compatible compiler</li>
<li>CMake 3.14 or higher</li>
<li>SQLite3 development libraries (only if SQLite backend is enabled)</li>
<li>Google Test (for building tests)</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Using CMake FetchContent</h2>
<p >The simplest way to use this library is to include it directly in your CMake project using FetchContent:</p>
<div class="fragment"><div class="line"># In your project&#39;s CMakeLists.txt</div>
<div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line">project(myproject)</div>
<div class="line"> </div>
<div class="line">include(FetchContent)</div>
<div class="line">FetchContent_Declare(</div>
<div class="line">    keyvaluestore</div>
<div class="line">    GIT_REPOSITORY https://github.com/HarryPehkonen/KeyValueStore.git</div>
<div class="line">    GIT_TAG main  # or specific tag/commit</div>
<div class="line">)</div>
<div class="line">FetchContent_MakeAvailable(keyvaluestore)</div>
<div class="line"> </div>
<div class="line"># Basic usage (memory-only)</div>
<div class="line">add_executable(myapp main.cpp)</div>
<div class="line">target_link_libraries(myapp PRIVATE keyvaluestore::keyvaluestore)</div>
<div class="line"> </div>
<div class="line"># Optional: Enable SQLite support during fetch</div>
<div class="line">FetchContent_Declare(</div>
<div class="line">    keyvaluestore</div>
<div class="line">    GIT_REPOSITORY https://github.com/HarryPehkonen/KeyValueStore.git</div>
<div class="line">    GIT_TAG main</div>
<div class="line">    CMAKE_ARGS</div>
<div class="line">        -DKEYVALUESTORE_USE_SQLITE=ON</div>
<div class="line">)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
Using CMake find_package</h2>
<div class="fragment"><div class="line"># First install keyvaluestore on your system:</div>
<div class="line">git clone https://github.com/HarryPehkonen/KeyValueStore.git</div>
<div class="line">cd keyvaluestore</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line"> </div>
<div class="line"># Basic build (memory-only)</div>
<div class="line">cmake ..</div>
<div class="line"># OR with SQLite support</div>
<div class="line">cmake -DKEYVALUESTORE_USE_SQLITE=ON ..</div>
<div class="line"> </div>
<div class="line">make</div>
<div class="line">sudo make install</div>
<div class="line"> </div>
<div class="line"># Then in your project&#39;s CMakeLists.txt, if you did the &quot;sudo make</div>
<div class="line"># install&quot; part:</div>
<div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line">project(myproject)</div>
<div class="line"> </div>
<div class="line">find_package(keyvaluestore REQUIRED)</div>
<div class="line"> </div>
<div class="line">add_executable(myapp main.cpp)</div>
<div class="line">target_link_libraries(myapp PRIVATE keyvaluestore::keyvaluestore)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Using add_subdirectory</h2>
<p >You can include the library directly in your project using <code>add_subdirectory</code>:</p>
<div class="fragment"><div class="line"># Project structure:</div>
<div class="line">myproject/</div>
<div class="line">├── CMakeLists.txt</div>
<div class="line">├── main.cpp</div>
<div class="line">└── extern/</div>
<div class="line">    └── keyvaluestore/  # clone of this library</div>
<div class="line"> </div>
<div class="line"># In your project&#39;s CMakeLists.txt:</div>
<div class="line">cmake_minimum_required(VERSION 3.14)</div>
<div class="line">project(myproject)</div>
<div class="line"> </div>
<div class="line"># Optional: Enable SQLite support</div>
<div class="line">set(KEYVALUESTORE_USE_SQLITE ON CACHE BOOL &quot;Enable SQLite backend&quot;)</div>
<div class="line"> </div>
<div class="line">add_subdirectory(extern/keyvaluestore)</div>
<div class="line"> </div>
<div class="line">add_executable(myapp main.cpp)</div>
<div class="line">target_link_libraries(myapp PRIVATE keyvaluestore::keyvaluestore)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Usage Examples</h1>
<h2><a class="anchor" id="autotoc_md8"></a>
Basic Usage with Memory Store</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="KeyValueStore_8hpp.html">keyvaluestore/KeyValueStore.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// Create an in-memory store</span></div>
<div class="line">        <span class="keyword">auto</span> store = <a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a6737fe9d146da86bc7c658144a798b2d">keyvaluestore::KeyValueStore::createInMemory</a>();</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Store different types of values</span></div>
<div class="line">        store-&gt;set(1, <span class="stringliteral">&quot;string_key&quot;</span>, std::string(<span class="stringliteral">&quot;Hello, World!&quot;</span>));</div>
<div class="line">        store-&gt;set(1, <span class="stringliteral">&quot;int_key&quot;</span>, 42);</div>
<div class="line">        store-&gt;set(1, <span class="stringliteral">&quot;double_key&quot;</span>, 3.14159);</div>
<div class="line">        store-&gt;set(1, <span class="stringliteral">&quot;bool_key&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Retrieve values</span></div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">auto</span> value = store-&gt;get(1, <span class="stringliteral">&quot;string_key&quot;</span>)) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;String value: &quot;</span> </div>
<div class="line">                     &lt;&lt; std::get&lt;std::string&gt;(value.value()) &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Check if key exists</span></div>
<div class="line">        <span class="keywordflow">if</span> (store-&gt;exists(1, <span class="stringliteral">&quot;int_key&quot;</span>)) {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Integer value: &quot;</span> </div>
<div class="line">                     &lt;&lt; std::get&lt;int&gt;(store-&gt;get(1, <span class="stringliteral">&quot;int_key&quot;</span>).value()) &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Remove a key</span></div>
<div class="line">        store-&gt;remove(1, <span class="stringliteral">&quot;bool_key&quot;</span>);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// Remove all keys for script ID 1</span></div>
<div class="line">        <span class="keywordtype">size_t</span> removed = store-&gt;remove_all(1);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Removed &quot;</span> &lt;&lt; removed &lt;&lt; <span class="stringliteral">&quot; keys&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="classkeyvaluestore_1_1KeyValueStoreError.html">keyvaluestore::KeyValueStoreError</a>&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Storage error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aKeyValueStore_8hpp_html"><div class="ttname"><a href="KeyValueStore_8hpp.html">KeyValueStore.hpp</a></div></div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStoreError_html"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStoreError.html">keyvaluestore::KeyValueStoreError</a></div><div class="ttdef"><b>Definition:</b> KeyValueStore.hpp:15</div></div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStore_html_a6737fe9d146da86bc7c658144a798b2d"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStore.html#a6737fe9d146da86bc7c658144a798b2d">keyvaluestore::KeyValueStore::createInMemory</a></div><div class="ttdeci">static std::unique_ptr&lt; KeyValueStore &gt; createInMemory()</div><div class="ttdoc">Creates an in-memory key-value store.</div><div class="ttdef"><b>Definition:</b> KeyValueStore.cpp:10</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Using SQLite Backend</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="KeyValueStore_8hpp.html">keyvaluestore/KeyValueStore.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <span class="comment">// Check if SQLite support is available</span></div>
<div class="line"><span class="preprocessor">        #ifdef KEYVALUESTORE_USE_SQLITE</span></div>
<div class="line">            <span class="comment">// Create a SQLite-backed store</span></div>
<div class="line">            <span class="keyword">auto</span> store = keyvaluestore::KeyValueStore::createSQLite(<span class="stringliteral">&quot;mydb.sqlite&quot;</span>);</div>
<div class="line">            </div>
<div class="line">            <span class="comment">// Use the store just like the memory version</span></div>
<div class="line">            store-&gt;set(1, <span class="stringliteral">&quot;user_name&quot;</span>, std::string(<span class="stringliteral">&quot;Alice&quot;</span>));</div>
<div class="line">            store-&gt;set(1, <span class="stringliteral">&quot;user_age&quot;</span>, 30);</div>
<div class="line">            store-&gt;set(1, <span class="stringliteral">&quot;premium_member&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">            </div>
<div class="line">            <span class="comment">// Later, retrieve the values</span></div>
<div class="line">            <span class="keywordflow">if</span> (<span class="keyword">auto</span> name = store-&gt;get(1, <span class="stringliteral">&quot;user_name&quot;</span>)) {</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;User: &quot;</span> &lt;&lt; std::get&lt;std::string&gt;(name.value()) &lt;&lt; std::endl;</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">        #else</span></div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;SQLite support not available in this build&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="preprocessor">        #endif</span></div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code hl_class" href="classkeyvaluestore_1_1KeyValueStoreError.html">keyvaluestore::KeyValueStoreError</a>&amp; e) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Storage error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Script Isolation Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="KeyValueStore_8hpp.html">keyvaluestore/KeyValueStore.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> processUserData(<a class="code hl_class" href="classkeyvaluestore_1_1KeyValueStore.html">keyvaluestore::KeyValueStore</a>&amp; store, <span class="keywordtype">int</span> user_id) {</div>
<div class="line">    <span class="comment">// Each user&#39;s data is isolated by using their ID as the script_id</span></div>
<div class="line">    store.<a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a2c5804ce6c3c6573ea546167020f3479">set</a>(user_id, <span class="stringliteral">&quot;last_login&quot;</span>, std::string(<span class="stringliteral">&quot;2024-11-09&quot;</span>));</div>
<div class="line">    store.<a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a2c5804ce6c3c6573ea546167020f3479">set</a>(user_id, <span class="stringliteral">&quot;login_count&quot;</span>, 42);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Data from one user doesn&#39;t interfere with another</span></div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> login = store.<a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a32efbf96abe01c54d56706f026150b16">get</a>(user_id, <span class="stringliteral">&quot;last_login&quot;</span>)) {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;User &quot;</span> &lt;&lt; user_id &lt;&lt; <span class="stringliteral">&quot; last login: &quot;</span> </div>
<div class="line">                  &lt;&lt; std::get&lt;std::string&gt;(login.value()) &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> store = <a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a6737fe9d146da86bc7c658144a798b2d">keyvaluestore::KeyValueStore::createInMemory</a>();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Process data for different users</span></div>
<div class="line">    processUserData(*store, 1);</div>
<div class="line">    processUserData(*store, 2);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Each user&#39;s data remains separate</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;User 1 exists: &quot;</span> &lt;&lt; store-&gt;<a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a7d9bcf5c439776481e39be8ae0b3d4d3">exists</a>(1, <span class="stringliteral">&quot;last_login&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;User 2 exists: &quot;</span> &lt;&lt; store-&gt;<a class="code hl_function" href="classkeyvaluestore_1_1KeyValueStore.html#a7d9bcf5c439776481e39be8ae0b3d4d3">exists</a>(2, <span class="stringliteral">&quot;last_login&quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStore_html"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStore.html">keyvaluestore::KeyValueStore</a></div><div class="ttdoc">Abstract interface for key-value store implementations.</div><div class="ttdef"><b>Definition:</b> KeyValueStore.hpp:42</div></div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStore_html_a2c5804ce6c3c6573ea546167020f3479"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStore.html#a2c5804ce6c3c6573ea546167020f3479">keyvaluestore::KeyValueStore::set</a></div><div class="ttdeci">virtual void set(int script_id, const std::string &amp;key, const ValueType &amp;value)=0</div><div class="ttdoc">Sets a value for a given script ID and key.</div></div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStore_html_a32efbf96abe01c54d56706f026150b16"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStore.html#a32efbf96abe01c54d56706f026150b16">keyvaluestore::KeyValueStore::get</a></div><div class="ttdeci">virtual std::optional&lt; ValueType &gt; get(int script_id, const std::string &amp;key)=0</div></div>
<div class="ttc" id="aclasskeyvaluestore_1_1KeyValueStore_html_a7d9bcf5c439776481e39be8ae0b3d4d3"><div class="ttname"><a href="classkeyvaluestore_1_1KeyValueStore.html#a7d9bcf5c439776481e39be8ae0b3d4d3">keyvaluestore::KeyValueStore::exists</a></div><div class="ttdeci">virtual bool exists(int script_id, const std::string &amp;key)=0</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11"></a>
Build Configuration</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
CMake Options</h2>
<ul>
<li><code>KEYVALUESTORE_USE_SQLITE</code>: Build with SQLite backend support (OFF by default)</li>
<li><code>KEYVALUESTORE_BUILD_TESTS</code>: Build the test suite (ON by default)</li>
<li><code>KEYVALUESTORE_BUILD_DOCS</code>: Build documentation (ON by default)</li>
<li><code>KEYVALUESTORE_BUILD_EXAMPLES</code>: Build example applications (ON by default)</li>
<li><code>KEYVALUESTORE_BUILD_COVERAGE</code>: Build with coverage information (OFF by default)</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Build Types</h2>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line"> </div>
<div class="line"># Debug build (includes debug symbols, no optimization)</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Debug ..</div>
<div class="line"> </div>
<div class="line"># Release build (optimized, no debug info)</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Release ..</div>
<div class="line"> </div>
<div class="line"># RelWithDebInfo (optimized, includes debug info)</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=RelWithDebInfo ..</div>
<div class="line"> </div>
<div class="line"># Build with SQLite support</div>
<div class="line">cmake -DKEYVALUESTORE_USE_SQLITE=ON ..</div>
<div class="line"> </div>
<div class="line">make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Building Documentation</h2>
<div class="fragment"><div class="line"># Configure with documentation enabled</div>
<div class="line">cmake -DKEYVALUESTORE_BUILD_DOCS=ON ..</div>
<div class="line">make docs</div>
<div class="line"> </div>
<div class="line"># Open the documentation</div>
<div class="line">open docs/html/index.html  # On macOS</div>
<div class="line">xdg-open docs/html/index.html  # On Linux</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Code Coverage</h2>
<p >To build with code coverage support: </p><div class="fragment"><div class="line"># Configure with coverage enabled (requires Debug build)</div>
<div class="line">cmake -DCMAKE_BUILD_TYPE=Debug -DKEYVALUESTORE_BUILD_COVERAGE=ON ..</div>
<div class="line">make</div>
<div class="line"> </div>
<div class="line"># Build and run the tests to generate coverage data</div>
<div class="line">make coverage</div>
<div class="line"> </div>
<div class="line"># Open the coverage report</div>
<div class="line">open build/coverage_report/index.html  # On macOS</div>
<div class="line">xdg-open build/coverage_report/index.html  # On Linux</div>
</div><!-- fragment --><p >Requirements for coverage:</p><ul>
<li>Debug build (<code>CMAKE_BUILD_TYPE=Debug</code>)</li>
<li>gcov and lcov installed on your system</li>
<li>Tests enabled (<code>KEYVALUESTORE_BUILD_TESTS=ON</code>)</li>
</ul>
<p >Note: Coverage analysis with optimized builds may produce misleading results and is not recommended.</p>
<p >To install the required tools: </p><div class="fragment"><div class="line"># Ubuntu/Debian</div>
<div class="line">sudo apt-get install lcov</div>
<div class="line"> </div>
<div class="line"># macOS</div>
<div class="line">brew install lcov</div>
<div class="line"> </div>
<div class="line"># Fedora</div>
<div class="line">sudo dnf install lcov</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
API Reference</h1>
<p >The library provides a common interface through the <code>KeyValueStore</code> base class:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>KeyValueStore {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Factory methods</span></div>
<div class="line">    <span class="keyword">static</span> std::unique_ptr&lt;KeyValueStore&gt; createInMemory();</div>
<div class="line"><span class="preprocessor">#ifdef KEYVALUESTORE_USE_SQLITE</span></div>
<div class="line">    <span class="keyword">static</span> std::unique_ptr&lt;KeyValueStore&gt; createSQLite(<span class="keyword">const</span> std::string&amp; db_path);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Core operations</span></div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">void</span> set(<span class="keywordtype">int</span> script_id, <span class="keyword">const</span> std::string&amp; key, </div>
<div class="line">                    <span class="keyword">const</span> <a class="code hl_typedef" href="namespacekeyvaluestore.html#a91a59257992320b302cbdb590d392f95">ValueType</a>&amp; value) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> std::optional&lt;ValueType&gt; get(<span class="keywordtype">int</span> script_id, </div>
<div class="line">                                       <span class="keyword">const</span> std::string&amp; key) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> exists(<span class="keywordtype">int</span> script_id, <span class="keyword">const</span> std::string&amp; key) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> remove(<span class="keywordtype">int</span> script_id, <span class="keyword">const</span> std::string&amp; key) = 0;</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> remove_all(<span class="keywordtype">int</span> script_id) = 0;</div>
<div class="line">};</div>
<div class="ttc" id="anamespacekeyvaluestore_html_a91a59257992320b302cbdb590d392f95"><div class="ttname"><a href="namespacekeyvaluestore.html#a91a59257992320b302cbdb590d392f95">keyvaluestore::ValueType</a></div><div class="ttdeci">std::variant&lt; std::string, int, double, bool &gt; ValueType</div><div class="ttdef"><b>Definition:</b> KeyValueStore.hpp:12</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
Key Methods</h2>
<ul>
<li><code>createInMemory()</code>: Creates a new in-memory store instance</li>
<li><code>createSQLite()</code>: Creates a new SQLite-backed store instance (if available)</li>
<li><code>set()</code>: Store a value with the given key for a specific script</li>
<li><code>get()</code>: Retrieve a value by key for a specific script</li>
<li><code>exists()</code>: Check if a key exists for a specific script</li>
<li><code>remove()</code>: Remove a key-value pair for a specific script</li>
<li><code>remove_all()</code>: Remove all key-value pairs for a specific script</li>
</ul>
<h1><a class="anchor" id="autotoc_md18"></a>
Performance Considerations</h1>
<ul>
<li>The in-memory implementation provides the fastest access but doesn't persist data</li>
<li>The SQLite implementation (when available):<ul>
<li>Uses Write-Ahead Logging (WAL) for better concurrency</li>
<li>Maintains prepared statements for common operations</li>
<li>Provides ACID guarantees for data persistence</li>
<li>Uses indices for efficient script_id-based queries</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md19"></a>
Thread Safety</h1>
<p >Both implementations are thread-safe:</p><ul>
<li>In-memory store uses a shared mutex for read-write synchronization</li>
<li>SQLite store uses SQLite's built-in thread safety with additional mutex protection</li>
</ul>
<h1><a class="anchor" id="autotoc_md20"></a>
Error Handling</h1>
<p >The library uses exceptions for error handling:</p><ul>
<li>All operations may throw <code>KeyValueStoreError</code> for serious errors</li>
<li>Non-exceptional conditions (like key not found) use return values</li>
<li>The SQLite implementation includes detailed error messages from the database</li>
</ul>
<h1><a class="anchor" id="autotoc_md21"></a>
Contributing</h1>
<p >Contributions are welcome! Please feel free to submit a Pull Request. For development, you can clone the repository using either:</p>
<ul>
<li>HTTPS: <code>git clone <a href="https://github.com/HarryPehkonen/KeyValueStore.git">https://github.com/HarryPehkonen/KeyValueStore.git</a></code></li>
<li><code>SSH:</code>git clone <a href="#" onclick="location.href='mai'+'lto:'+'git'+'@g'+'ith'+'ub'+'.co'+'m'; return false;">git@g<span class="obfuscator">.nosp@m.</span>ithu<span class="obfuscator">.nosp@m.</span>b.com</a>:HarryPehkonen/KeyValueStore.git</li>
</ul>
<h1><a class="anchor" id="autotoc_md22"></a>
License</h1>
<p >This project is released into the public domain - see the [LICENSE](LICENSE) file for details. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Nov 16 2024 07:34:16 for keyvaluestore by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
